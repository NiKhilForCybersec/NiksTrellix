<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshoot Endpoint - Trellix Documentation</title>
    <link rel="stylesheet" href="../css/main.css">
</head>
<body>
    <header class="header">
        <div class="header-logo">
            <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 4L4 12v16l16 8 16-8V12L20 4z" stroke="url(#grad1)" stroke-width="2" fill="none"/>
                <path d="M20 12l-8 4v8l8 4 8-4v-8l-8-4z" fill="url(#grad1)"/>
                <defs><linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#ff6b35"/><stop offset="100%" style="stop-color:#ff8c42"/></linearGradient></defs>
            </svg>
            <span class="header-logo-text">Trellix Docs</span>
        </div>
        <nav class="header-nav">
            <a href="../index.html">Home</a>
            <a href="epo-fundamentals.html">ePO</a>
            <a href="endpoint-security.html">Endpoint</a>
            <a href="edr-fundamentals.html">EDR</a>
            <a href="dlp-architecture.html">DLP</a>
            <a href="troubleshooting.html" class="active">Troubleshooting</a>
        </nav>
        <div class="header-search"><input type="text" placeholder="Search docs... (Ctrl+K)" aria-label="Search documentation"></div>
        <button class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
    </header>

    <aside class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-section-title">Troubleshooting</div>
            <ul class="sidebar-nav">
                <li><a href="troubleshooting.html">Master Guide</a></li>
                <li><a href="troubleshoot-epo.html">ePO Issues</a></li>
                <li><a href="troubleshoot-endpoint.html" class="active">Endpoint Issues</a></li>
            </ul>
        </div>
    </aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="page-header">
                <div class="page-breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="troubleshooting.html">Troubleshooting</a><span class="separator">/</span>
                    <span>Endpoint Issues</span>
                </div>
                <h1>Troubleshoot Endpoint Issues</h1>
                <p class="hero-subtitle">Common McAfee Agent and ENS problems with resolution steps.</p>
                <div class="page-meta">
                    <span class="page-meta-item"><span class="badge endpoint">Endpoint</span></span>
                </div>
            </div>

            <section>
                <h2>Agent Issues</h2>

                <div class="accordion">
                    <div class="accordion-item active">
                        <button class="accordion-header">
                            <span>üî¥ Agent Not Checking In</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Symptoms:</h5>
                            <ul>
                                <li>System shows "Not Managed" or stale last communication time in ePO</li>
                                <li>Policies not updating on endpoint</li>
                            </ul>
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Verify agent service is running:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Check Agent Service</span></div>
<pre>sc query "McAfee Agent Service"
# Or: Get-Service -Name "masvc"</pre>
                                    </div>
                                </li>
                                <li>Force check-in manually:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Force Check-in</span></div>
<pre>cd "C:\Program Files\McAfee\Agent"
cmdagent.exe -p    # Collect and send props
cmdagent.exe -c    # Force full check-in</pre>
                                    </div>
                                </li>
                                <li>Verify network connectivity to ePO:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Test Connectivity</span></div>
<pre># Test connection to ePO server
Test-NetConnection -ComputerName eposerver.domain.com -Port 443

# Check sitelist.xml for server entries
type "C:\ProgramData\McAfee\Agent\sitelist.xml"</pre>
                                    </div>
                                </li>
                                <li>Check agent logs for errors:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Agent Logs</span></div>
<pre>C:\ProgramData\McAfee\Agent\Logs\masvc.log
C:\ProgramData\McAfee\Agent\Logs\macmnsvc.log</pre>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ Agent Not Receiving Policies</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Force policy enforcement:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Force Policy</span></div>
<pre>cmdagent.exe -e    # Enforce policies now</pre>
                                    </div>
                                </li>
                                <li>Wake up agent from ePO console (System Tree ‚Üí Actions ‚Üí Agent ‚Üí Wake Up)</li>
                                <li>Verify system is in correct System Tree group</li>
                                <li>Check policy inheritance is not broken</li>
                                <li>Verify no policy assignment conflicts</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ Agent Installation Fails</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Check for conflicting AV software (uninstall first)</li>
                                <li>Run installer as administrator</li>
                                <li>Check Windows Installer service is running</li>
                                <li>Verify .NET Framework 4.7.2+ installed</li>
                                <li>Check install log for specific errors:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Install with Logging</span></div>
<pre>FramePkg.exe /install=agent /silent /log=C:\temp\agent_install.log</pre>
                                    </div>
                                </li>
                                <li>Use McAfee Agent Removal Tool to clean previous installation</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h2>ENS Issues</h2>

                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ Slow System Performance</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Check if on-demand scan running (view ENS console)</li>
                                <li>Add exclusions for high-I/O applications:
                                    <ul>
                                        <li>SQL Server data files</li>
                                        <li>Exchange databases</li>
                                        <li>Development folders (node_modules, .git)</li>
                                        <li>Backup software paths</li>
                                    </ul>
                                </li>
                                <li>Optimize scan settings:
                                    <ul>
                                        <li>Reduce archive scan depth</li>
                                        <li>Enable scan cache</li>
                                        <li>Use default file types scanning</li>
                                    </ul>
                                </li>
                                <li>Check ENS service CPU usage:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Check CPU</span></div>
<pre>Get-Process mfetp, mfemms, McAPExe | Select Name, CPU, WorkingSet</pre>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ DAT Updates Not Working</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Check current DAT version:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Check DAT</span></div>
<pre>reg query "HKLM\SOFTWARE\McAfee\AVEngine" /v AVDatVersion
cmdagent.exe -i | findstr DAT</pre>
                                    </div>
                                </li>
                                <li>Force update from repository:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Force Update</span></div>
<pre>cmdagent.exe -u    # Update from repository</pre>
                                    </div>
                                </li>
                                <li>Verify repository connectivity:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Check Repositories</span></div>
<pre>cmdagent.exe -r    # List available repositories</pre>
                                    </div>
                                </li>
                                <li>Check sitelist.xml for valid repository URLs</li>
                                <li>Verify proxy settings if applicable</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ False Positive Detection</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Identify the detection:
                                    <ul>
                                        <li>Check ENS Event Log for threat name</li>
                                        <li>Note file path and hash</li>
                                    </ul>
                                </li>
                                <li>Verify legitimacy:
                                    <ul>
                                        <li>Check file signature (right-click ‚Üí Properties ‚Üí Digital Signatures)</li>
                                        <li>Submit to VirusTotal for multi-engine scan</li>
                                        <li>Check Trellix GTI reputation</li>
                                    </ul>
                                </li>
                                <li>Create exclusion if legitimate:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Exclusion Types</span></div>
<pre># Best practice order (most to least secure):
1. By SHA-256 hash (most specific)
2. By certificate/signer
3. By file path (less secure)
4. By extension (avoid if possible)</pre>
                                    </div>
                                </li>
                                <li>Report false positive to Trellix Labs</li>
                            </ol>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <button class="accordion-header">
                            <span>üî¥ ENS Services Not Starting</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content">
                            <h5>Resolution Steps:</h5>
                            <ol>
                                <li>Check service status:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Service Check</span></div>
<pre>sc query mfetp
sc query mfemms
sc query mfefwc
sc query mfewc</pre>
                                    </div>
                                </li>
                                <li>Check ENS logs for errors:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">ENS Logs</span></div>
<pre>C:\ProgramData\McAfee\Endpoint Security\Logs\EndpointSecurityPlatform.log
C:\ProgramData\McAfee\Endpoint Security\Logs\ThreatPrevention.log</pre>
                                    </div>
                                </li>
                                <li>Restart Module Management Service:
                                    <div class="code-block">
                                        <div class="code-block-header"><span class="code-block-title">Restart Service</span></div>
<pre>net stop mfemms
net start mfemms</pre>
                                    </div>
                                </li>
                                <li>Repair ENS installation if services won't start</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h2>Diagnostic Commands Quick Reference</h2>

                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-title">cmdagent.exe Commands</span>
                        <button class="code-block-copy">Copy</button>
                    </div>
<pre># Agent status and info
cmdagent.exe -i          # Display agent info
cmdagent.exe -s          # Show agent status

# Communication
cmdagent.exe -p          # Collect and send properties
cmdagent.exe -c          # Force check-in to ePO
cmdagent.exe -f          # Force full properties collection

# Policy and updates
cmdagent.exe -e          # Enforce policies
cmdagent.exe -u          # Update from repository

# Repository
cmdagent.exe -r          # List repositories
cmdagent.exe -v          # Verbose repository test</pre>
                </div>
            </section>

            <section>
                <h2>Collect Diagnostic Data</h2>

                <div class="callout tip">
                    <div class="callout-icon">üí°</div>
                    <div class="callout-content">
                        <div class="callout-title">MER Tool</div>
                        <p>Use the Minimum Escalation Requirements (MER) tool to collect comprehensive diagnostic data for support cases.</p>
                    </div>
                </div>

                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-title">MER Collection</span>
                    </div>
<pre># Download MER tool from Trellix support portal
# Run as administrator

MER.exe -silent -all                    # Collect all logs
MER.exe -silent -products "MA,ENS"      # Specific products
MER.exe -silent -output C:\temp\MER     # Custom output location

# Output: .tgz file for support case upload</pre>
                </div>
            </section>

            <div class="flex justify-between mt-4" style="padding-top: var(--spacing-xl); border-top: 1px solid var(--border-primary);">
                <a href="troubleshoot-epo.html" class="btn btn-ghost">‚Üê ePO Issues</a>
                <a href="../index.html" class="btn btn-primary">Back to Home ‚Üí</a>
            </div>
        </div>
    </main>
    <script src="../js/main.js"></script>
</body>
</html>
